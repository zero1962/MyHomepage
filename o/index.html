<HTML>
<HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--
	window.resizeTo(500,700);
	window.moveTo(500,0);
//-->
</SCRIPT>
<TITLE>JavaScriptオセロ盤</TITLE>

<STYLE TYPE="text/css">
<!--
    IMG{height:32px;width:32px;margin: 0px; border: 0px; padding: 0px}
    INPUT{font-size:100%}
    SELECT{font-size:100%}
    TEXTAREA{font-size:100%}
    TABLE{font-size:100%;line-height:0%}
    BODY{font-size:100%;line-height:120%}
-->
</STYLE>
<SCRIPT language="JavaScript">
<!-- 
var num=0;
var sx,sy;
var nx,ny;
var cB=0,cW=0;
var mes='';
var judge=0;
var oldNum=-1;

var hyouji=1;

var aite=1;

undo=new Array(64);
route=new Array(128);
roulg=new Array(128);

var tekazu=-1;
var tekalg;

var logst,logmd=0;

var kflg=0;
s=new Array(64);
OK=new Array(7);
kx=new Array(-1,-1,-1,0,0,1,1,1);
ky=new Array(-1,0,1,-1,1,-1,0,1);
rn=new Array(0,1,8,57,64,2,7,16,56,63,58,49,9,3,6,24,48,62,59,41,17,4,5,32,40,61,60,33,25,10,11,12,13,14,15,18,19,20,21,22,23,26,27,28,29,30,31,34,35,36,37,38,39,42,43,44,45,46,47,50,51,52,53,54,55);

for(i=0;i<64;i++){s[i]=0}
var pic=new Array(); //配列の作成

for (i=0; i<=5; i++){
 pic[i]=new Image(); //Imageオブジェクトの作成
}

pic[0].src="fig/aki.png";
pic[1].src="fig/black.png";
pic[2].src="fig/white.png";
pic[3].src="fig/Kblack.png";
pic[4].src="fig/Kwhite.png";

function hajime(){
    for(i=0; i<=64; i++){s[i]=0;}
    s[n(1,0)]=2;te=2;ta=1;
    s[n(4,4)]=1;
    s[n(4,5)]=2;
    s[n(5,4)]=2;
    s[n(5,5)]=1;
    for(i=0;i<=64;i++){komaset(i)}
    window.status = "走ってるよ？";
    document.form.stt.value=mes;
    tekazu=-1;hyouji=1;
    undomemo();
    document.form1.LOG.value="";
    document.form.BP.value="2";
    document.form.WP.value="2";
    rand();
    MDchange();
}

function MDchange(){MD=document.formT.MD.value}

function turchan(){
    if(document.form.stt.value=="パス"){document.form.stt.value=""}
    te=ta;ta=3-te;s[0]=te;komaset(0);
}

function poschk(x,y){
    if(x>=1 && x<=8 && y>=1 && y<=8){return s[n(x,y)]}else{return -1}
}

function clicked(x,y){
　   if(oldNum>0){komaset(oldNum)}

sx=x;sy=y;
mes='';

    num=n(x,y);
    for(i=0; i<=7; i++){OK[i]=0;}
    if(poschk(x,y)==0){
//------------------------------------
    // 八方をチェックする
    for(h=0;h<=7;h++){
    if(poschk(x+kx[h],y+ky[h])==ta){
        for(i=2; i<=8; i++){
            dmy=poschk(x+i*kx[h],y+i*ky[h]);
            if(dmy==te){OK[h]=i-1;break}
            else if(dmy<=0){break}
    }   }   }

//------------------------------------
    }
judge=OK[0]+OK[1]+OK[2]+OK[3]+OK[4]+OK[5]+OK[6]+OK[7];

if(num==0){turchan()}else{
    if(judge>0){
        mes='ＯＫ';
        if(hyouji==1){
        document.images[num].src=pic[te+2].src;
        }
        oldNum=num;
    }else{
        mes='ＮＧ';
    }
}
    if(document.form.stt.value != "探査中"||mes=="ＯＫ"){document.form.stt.value=mes}    
}

function kettei(){
    x=sx;y=sy;
    if(judge>0){
            undomemo();
            tekazu++;
            route[tekazu*2]=n(x,y);
            route[tekazu*2+1]=te;
            document.form1.LOG.value=document.form1.LOG.value+route[tekazu*2]+','+route[tekazu*2+1]+',';
        s[num]=te;
        komaset(num);
        for(h=0;h<8;h++){
            if(OK[h]>=1){
                hx=kx[h];hy=ky[h];
                for(i=1; i<OK[h]+1 ; i++){s[n(x+i*hx,y+i*hy)]=te;komaset(n(x+i*hx,y+i*hy))}
            }
        }
        document.form.stt.value='';
        oldNum=-1; 
        if(judge<100){turchan()} 
    }
    cB=0;cW=0;
    for(ii=1;ii<=64;ii++){
       if(s[ii]==1){cB++}else if(s[ii]==2){cW++}
    }
    document.form.BP.value=cB;
    document.form.WP.value=cW;
    document.formR.work.value=tekazu;
    if(te==aite && logmd==0 && MD>0){dairi(MD)}
}

function dairi(MD){
    document.form.stt.value="探査中";
    if(MD==1){yamikumo()}
    else if(MD==2){itteyomi()}
    else{yamikumo()}
    if(mes=='ＯＫ'){setTimeout("kettei()",1000)}else{
    if(tekazu<59){document.form.stt.value="パス"}else{document.form.stt.value="終了"}}
}

function rand(){
var dmy,dmy1,i;
    for(i=30;i<=64;i++){
        dmy=Math.floor(Math.random()*34)+30;
        dmy1=rn[dmy];rn[dmy]=rn[i];rn[i]=dmy1;
    }
}

function yamikumo(){
var i;
    for(i=1;i<=64;i++){
        clicked(zx(rn[i]),zy(rn[i]));
        if(mes=='ＯＫ'){break}
}   }

function itteyomi(){
var i,po=0,numx=1
    hyouji=0;
    for(i=1;i<=4;i++){
        clicked(zx(rn[i]),zy(rn[i]));
        if(mes=='ＯＫ' && po<judge){
            po=judge;numx=rn[i];
        }
    }
    if(po==0){
    for(i=5;i<=28;i++){
        clicked(zx(rn[i]),zy(rn[i]));
        if(mes=='ＯＫ' && po<judge){
            po=judge;numx=rn[i];
        }
    }}
    if(po==0){
    for(i=29;i<=64;i++){
        clicked(zx(rn[i]),zy(rn[i]));
        if(mes=='ＯＫ' && po<judge){
            po=judge;numx=rn[i];
        }
    }}
    hyouji=1;
    clicked(zx(numx),zy(numx));
}

function zx(num){return (num-1-(num-1)%8)/8+1}

function zy(num){return ((num-1)%8)+1}

function n(x,y){return (x-1)*8+y}

function undomemo(){var i;for(i=0;i<=64;i++){undo[i]=s[i]}}

function undoS(){
var i;
    for(i=0;i<=64;i++){
        s[i]=undo[i]; komaset(i);
    }
    te=s[0];ta=3-te;
    document.form1.LOG.value='';
    tekazu--;
    for(i=0;i<=tekazu;i++){
        document.form1.LOG.value=document.form1.LOG.value+route[i*2]+','+route[i*2+1]+',';
    }
}

function logread(){
    logall=document.form1.LOG.value;
    hajime();
    roulg=logall.split(',');
    document.form1.LOG.value="";
    for(i=0;i<64;i++){if(roulg[2*i]==""){tekalg=i;break}}    
    logst=-1;logmd=1;
}

function loggo(){
    logst++;
if(logst<tekalg){
    var dmy;
    te=parseInt(roulg[logst*2+1]);ta=3-te;
    dmy=parseInt(roulg[logst*2])

    document.formR.work.value=logst+"*"+te+"-"+zx(dmy)+","+zy(dmy);
    clicked(zx(dmy),zy(dmy));
    kettei();
}else(logmd=0)}

function komaset(i){document.images[i].src=pic[s[i]].src}

//-->
</SCRIPT>
</HEAD>
<BODY onLoad="hajime()">

<FORM name="formT">オセロ盤　
    <SELECT NAME="MD" onChange="MDchange()">
    　<OPTION  VALUE="0" SELECTED>２人
    　<OPTION  VALUE="1">闇雲ちゃん
    　<OPTION  VALUE="2">一手読みさんβ
    </SELECT>
</FORM>

<TABLE><TR><TD>
<FORM name="form">
●<INPUT TYPE="text" name="BP" size="2"><BR>
○<INPUT TYPE="text" name="WP" size="2"><BR>
<BR>
<IMG SRC="fig/aki.png" onClick="turchan()"><BR>
<INPUT TYPE="text" name="stt" size="6"><BR>
<INPUT TYPE="button" value="決定" onClick="kettei()"><BR><BR>
</form>
</TD><TD>

<TABLE BORDER="1" CELLSPACING="0" CELLPADDING="0" BORDERCOLOR="black" STYLE="font-size:1pt">
<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(1,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(2,1)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,2)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,3)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,4)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,5)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,6)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,7)"></TD><TD>  
<IMG SRC="fig/aki.png" onClick="clicked(2,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(3,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(4,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(5,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(6,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(7,8)"></TD></TR>

<TR><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,1)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,2)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,3)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,4)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,5)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,6)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,7)"></TD><TD>
<IMG SRC="fig/aki.png" onClick="clicked(8,8)"></TD></TR>

</TABLE></TD>

<TD>
<FORM NAME="formR">
<INPUT TYPE="button" value="お任せ" onClick="dairi()"><BR>
<INPUT TYPE="button" value="一つ前" onClick="undoS()"><BR><BR>
<INPUT TYPE="button" value="ログ読" onClick="if(confirm('今までの結果が全て消えます')==true) logread()"><BR>
<INPUT TYPE="button" value="→" onClick="loggo()"><BR>
<INPUT TYPE="text" name="work" size="5"><BR>
</FORM>


</TD></TR></TABLE><BR>
<FORM name="form1">
↓ログ記録　
<INPUT TYPE="button" value="リセット" onClick="if(confirm('今までの結果が全て消えます')==true) hajime()"><BR>
<TEXTAREA ROWS="7" COLS="25" NAME="LOG"></TEXTAREA>
</form1>
<HR>
</BODY>
</HTML>

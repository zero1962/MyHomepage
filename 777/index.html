<html>
<head>
<META name="Authour" content="SEKIUCHI Takayuki">
<META http-equiv="Content-Type" content="text/html; charset=x-sjis">
<SCRIPT LANGUAGE="JavaScript">
<!--
	window.resizeTo(500,700);
	window.moveTo(500,0);
//-->
</SCRIPT>

<title>SLOT MACHINE</title>
</head>
<body bgcolor="#88bbff">
<SCRIPT language="JavaScript1.1">
<!--
//////著作権欄  Copyright notice//////
//  SLOTMACHINE  Las Vegas  ver1.22
//  Copyright (C)1997, 1998, 1999  SEKIUCHI Takayuki. All rights reserved.
//  WEBSITE : http://www004.upp.so-net.ne.jp/sekiuchi/index.html
//  E-MAIL  : sekiuchi@anet.ne.jp
//  著作権欄の削除・変更をしなければ、Webページで使用することができます。
//  License is granted to user to reuse this code on their Web site, only if this entire copyright notice is included.


//////履歴  History//////
//  1997.08.02  ver1.0   公開
//  1997.10.04  ver1.1   表示のバグを修正
//  1997.12.04  ver1.2   遅い回線でのエラー修正など
//  1998.09.04  ver1.21  細かな変更
//  1999.08.01  ver1.22  IE5での動作不良解消

//  MSIE3.0で動かしたい方は、IMG1～0に入れる文字列を変え、SCRIPTタグのlanguage属性をJavaScriptに変更してください。(IE3.0は改行の出力ができないようなんですよね)

coin = 50      //初期コイン枚数
bet = 1
game = false   //スタートの二重押し禁止フラグ
box1 = true
box2 = true
box3 = true
num = Math.floor(Math.random() * 10)

//タイトル
document.write('<center><font size=6 color="#0000aa">SLOTMACHINE  Las Vegas  ver1.21</font></center>')

//数字を作るための文字列
IMG1 = " \n     BB\n    BBB\n   B BB\n     BB\n     BB\n     BB\n   BBBBBB "
IMG2 = " \n    BBBB\n  BB    BB\n        BB\n       BB\n     BB\n   BB\n  BBBBBBBB "
IMG3 = " \n    BBBB\n  BB    BB\n        BB\n    BBBBB\n        BB\n  BB    BB\n    BBBB "
IMG4 = " \n      BB\n     BBB\n    B BB\n   B  BB\n  B   BB\n BBBBBBBBB\n      BB "
IMG5 = " \n  BBBBBBB\n  B\n  B\n  BBBBBBB\n        BB\n  BB    BB\n    BBBB "
IMG6 = " \n    BBBB\n  BB     B\n  B\n  BBBBBBB\n  BB    BB\n  BB    BB\n    BBBB "
IMG7 = " \n BBBBBBBBB\n        BB\n       BB\n      BB\n     BB\n    B7\n   BB "
IMG8 = " \n    BBBB\n  BB    BB\n  B      B\n   BBBBBB\n  BB    BB\n  BB    BB\n    BBBB "
IMG9 = " \n   BBBBBB\n  BB    BB\n  BB    BB\n   BBBBBBB\n        BB\n       BB\n   BBBB "
IMG0 = " \n   BBBBBB\n  BB    BB\n  BB    BB\n  BB    BB\n  BB    BB\n  BB    BB\n   BBBBBB "

image = new Array(IMG1,IMG2,IMG3,IMG4,IMG5,IMG6,IMG7,IMG8,IMG9,IMG0)

//得点の計算
function keisan(){
                if((document.form.first.value == document.form.second.value) && (document.form.second.value == document.form.third.value) && (document.form.third.value.indexOf("7") >= 0)){
                    coin += bet * 100; //スリーセブンの時の倍率
                    document.form.pay_back.value="やったぁ！コイン"+(bet*100)+"枚の払い戻しです。　　コイン："+coin+"枚"
                }
                else if((document.form.first.value == document.form.second.value) && (document.form.second.value == document.form.third.value)){
                    coin += bet * 5; //３つそろったときの倍率
                    document.form.pay_back.value="コイン"+(bet*5)+"枚の払い戻しです。　　コイン："+coin+"枚";
                } else {
                    coin -= bet
                    document.form.pay_back.value="ざんねんでした！　　　コイン："+coin+"枚";
                }
             game = false
             box1 = true
             box2 = true
             box3 = true
}

//数字を止めるための関数
function end(variable){
        if(game == true){
                if(variable == 1)box1 = false
                if(variable == 2)box2 = false
                if(variable == 3)box3 = false
          }
        if((box1 == false) && (box2 == false) && (box3 == false)){
                clearTimeout(tid)
                keisan()
          }
}

//数字を変換し、ボタンを押したら止める。
function hyouji(){
       
       if(num == 10) num = 0
       if(box1)document.form.first.value = image[num % 10]
       if(box2)document.form.second.value = image[(num + 3) % 10]
       if(box3)document.form.third.value = image[(num + 6) % 10]
num += 1
tid = setTimeout("hyouji()",60)  //ここの数字を変えると、数字の変わる速さが変わります。(機種やブラウザ、メモリ搭載量にも左右される)
}

//賭金と所持金の処理
function inCoin(){
      if (document.forms[0].elements[6].options[0].selected) bet = 1;
      else if (document.forms[0].elements[6].options[1].selected) bet = 1;
      else if (document.forms[0].elements[6].options[2].selected) bet = 2;
      else if (document.forms[0].elements[6].options[3].selected) bet = 3;
      else if (document.forms[0].elements[6].options[4].selected) bet = 4;
      else if (document.forms[0].elements[6].options[5].selected) bet = 5;

      if((coin-bet) < 0){
          document.form.pay_back.value="コインが足りません。";
          game = false
        }
      else if (bet > 0){
          document.form.pay_back.value="現在残りのコインは"+(coin-bet)+"枚、ベットしたコインは"+bet+"枚です";
          hyouji()
        }
}
//ゲームの開始
function startGame(){
   if(game == false){
            game = true
        if (coin <= 0){
          document.form.pay_back.value="コインがありません。また来てね。"
           }else{
          inCoin()
         }
     }
}

//スロットマシーンのフォーム作成
document.write('<center><form name="form"><textarea rows=8 cols=12 name="first"></textarea><textarea rows=8 cols=12 name="second"></textarea><textarea rows=8 cols=12 name="third"></textarea><br>')
document.write('<input type="button" value="stop" name="firstb" onClick=end(1)>　　　　　<input type="button" value="stop" name="secondb" onClick=end(2)>　　　　　<input type="button" value="stop" name="thirdb" onClick=end(3)><br><br>')
document.write('<SELECT NAME="select" SIZE="1"><OPTION>INSERT COIN(S)<OPTION>1 COIN<OPTION>2 COINS<OPTION>3 COINS<OPTION>4 COINS<OPTION>5 COINS</SELECT>　<input type="button" value="  START  " onClick=startGame()><br><br><br>')
document.write('<input type="text" size=55 name="pay_back"></form></center>')

//ロード時のメッセージ
document.form.pay_back.value="最初のコインは"+coin+"枚。コインの枚数を選んで、STARTを押してね。"

//-->
</SCRIPT>
<center>ごゆっくりお楽しみください。<br>
<br>
<noscript>あなたのブラウザは、JavaScriptが利用できない状態になっているようです。<br></noscript>
<br>
</center>
</body>
</html>